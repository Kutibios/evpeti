<app-header [isLoggedIn]="isLoggedIn" [currentUser]="currentUser"></app-header>

<main>
  <div class="search-container">
    <h1>Evcil HayvanÄ±nÄ±z Ä°Ã§in GÃ¼venilir BakÄ±cÄ± Bulun</h1>
    <p>Deneyimli ve gÃ¼venilir bakÄ±cÄ±lar ile evcil hayvanÄ±nÄ±z gÃ¼vende</p>
    
    <div class="search-and-actions">
      <div class="search-form">
        <div class="search-inputs">
          <div class="input-group">
            <label for="location">Yer</label>
            <input type="text" id="location" placeholder="Åehir seÃ§in">
            <div id="location-dropdown" class="dropdown"></div>
          </div>
          
          <div class="input-group">
            <label for="start-date">BaÅŸlangÄ±Ã§ Tarihi</label>
            <input type="date" id="start-date">
          </div>
          
          <div class="input-group">
            <label for="end-date">BitiÅŸ Tarihi</label>
            <input type="date" id="end-date">
          </div>
          
          <div class="input-group">
            <label for="pet-type">Hayvan TÃ¼rÃ¼</label>
            <input type="text" id="pet-type" placeholder="Hayvan tÃ¼rÃ¼ seÃ§in">
            <div id="pet-type-dropdown" class="dropdown"></div>
          </div>
        </div>
        
        <button id="search-button" class="search-button">
          <img src="assets/search.png" alt="Ara">
          Ara
        </button>
      </div>
      
      <div class="action-buttons">
        <button class="create-pet-profile-btn" *ngIf="!isLoggedIn" (click)="showLoginRequired('pet')">
          ğŸ• Pet Profili OluÅŸtur
        </button>
        <button class="create-sitter-profile-btn" *ngIf="!isLoggedIn" (click)="showLoginRequired('sitter')">
          ğŸ  BakÄ±cÄ± Profili OluÅŸtur
        </button>
        <button class="create-pet-profile-btn" *ngIf="isLoggedIn" (click)="createPetProfile()">
          ğŸ• Pet Profili OluÅŸtur
        </button>
        <button class="create-sitter-profile-btn" *ngIf="isLoggedIn" (click)="createSitterProfile()">
          ğŸ  BakÄ±cÄ± Profili OluÅŸtur
        </button>
      </div>
    </div>
  </div>

  <div class="listings-section">
    <h2>AÃ§Ä±lan Ä°lanlar</h2>
    
    <div class="filters-container">
      <div class="filter-group">
        <label for="price-filter">Fiyat:</label>
        <select id="price-filter">
          <option value="">TÃ¼mÃ¼</option>
          <option value="0-50">0-50 TL</option>
          <option value="50-100">50-100 TL</option>
          <option value="100-150">100-150 TL</option>
          <option value="150-200">150-200 TL</option>
          <option value="200-">200+ TL</option>
        </select>
      </div>
      
      <div class="filter-group">
        <label for="pet-filter">Hayvan TÃ¼rÃ¼:</label>
        <select id="pet-filter">
          <option value="">TÃ¼mÃ¼</option>
          <option value="KÃ¶pek">KÃ¶pek</option>
          <option value="Kedi">Kedi</option>
          <option value="KuÅŸ">KuÅŸ</option>
          <option value="DiÄŸer">DiÄŸer</option>
        </select>
      </div>
      
      <div class="filter-group">
        <label for="sort-filter">SÄ±rala:</label>
        <select id="sort-filter">
          <option value="newest">En Yeni</option>
          <option value="price-low">Fiyat (DÃ¼ÅŸÃ¼k-YÃ¼ksek)</option>
          <option value="price-high">Fiyat (YÃ¼ksek-DÃ¼ÅŸÃ¼k)</option>
          <option value="rating">Puan</option>
        </select>
      </div>
      
      <button class="clear-filters-btn">Filtreleri Temizle</button>
    </div>

    <div class="listings-grid" id="listings-grid">
      <!-- Loading State -->
      <div class="loading-state" *ngIf="isLoading">
        <div class="loading-spinner"></div>
        <p>Ä°lanlar yÃ¼kleniyor...</p>
      </div>

      <!-- No Listings State -->
      <div class="no-listings" *ngIf="!isLoading && listings.length === 0">
        <p>HenÃ¼z ilan bulunmuyor.</p>
      </div>

      <!-- Listings -->
      <div class="listing-card" *ngFor="let listing of listings">
        <!-- Listing Image -->
        <div class="listing-image" *ngIf="listing.imageUrls && getImageUrls(listing.imageUrls).length > 0">
          <img [src]="getImageUrls(listing.imageUrls)[0]" 
               [alt]="listing.title || 'Ä°lan fotoÄŸrafÄ±'"
               class="listing-photo">
        </div>
        <div class="listing-image" *ngIf="!listing.imageUrls || getImageUrls(listing.imageUrls).length === 0">
          {{ getPetEmoji(listing.type) }}
        </div>

        <div class="listing-content">
          <div class="listing-header">
            <div>
              <div class="listing-title">{{ listing.title || 'BaÅŸlÄ±ksÄ±z Ä°lan' }}</div>
              <div class="listing-location">ğŸ“ {{ listing.location }}</div>
            </div>
            <div class="listing-price">{{ listing.price }} â‚º/gÃ¼n</div>
          </div>
          <div class="listing-details">
            <div class="listing-detail">ğŸ¾ {{ listing.type }}</div>
            <div class="listing-detail" *ngIf="listing.experience">â­ {{ listing.experience }} yÄ±l</div>
            <div class="listing-detail">ğŸ“… {{ listing.createdAt | date:'dd/MM/yyyy' }}</div>
          </div>
          
          <!-- User bilgileri -->
          <div class="listing-user-info" *ngIf="listing.userName">
            <div class="user-avatar">ğŸ‘¤</div>
            <div class="user-details">
              <div class="user-name">{{ listing.userName }}</div>
              <div class="user-contact" *ngIf="listing.userEmail">{{ listing.userEmail }}</div>
            </div>
          </div>
          <div class="listing-description">{{ listing.description || 'AÃ§Ä±klama bulunmuyor.' }}</div>
          <div class="listing-footer">
            <div class="listing-rating" *ngIf="listing.experience">â­ {{ listing.experience }} yÄ±l deneyim</div>
            <div class="listing-date">{{ listing.createdAt | date:'dd/MM/yyyy' }}</div>
          </div>
        </div>
      </div>
    </div>

    <div class="load-more-container" *ngIf="hasMoreListings">
      <button class="load-more-btn" 
              (click)="loadMoreListings()" 
              [disabled]="isLoading">
        <span *ngIf="!isLoading">Daha Fazla YÃ¼kle</span>
        <span *ngIf="isLoading" class="loading-text">YÃ¼kleniyor...</span>
      </button>
    </div>
  </div>
</main> 